<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<istar_reports>

	<!-- Creative Admin -->
	<reports id="0" type_of_report="pie">

		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>SELECT
			course.course_name, COUNT (*)

			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id

			GROUP BY
			course.course_name
		</sql>
		<title>Tasks by Course</title>
	</reports>
	<reports id="1" type_of_report="pie">

		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="name" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>SELECT
			content_creator.name, COUNT (*)

			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id

			GROUP BY
			content_creator.name
		</sql>
		<title>Tasks by Assignee </title>
	</reports>
	
	<reports id="2" type_of_report="pie">

		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="status" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>
			SELECT
			task.status, COUNT (*)
		
			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id
		
			GROUP BY
			task.status
		</sql>
		<title>Tasks by Status </title>
	</reports>
	
	<reports id="100" type_of_report="column">
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="status" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>SELECT
			course_name, task.status, COUNT (*)
			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course, task_log
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id
			and task_log.task_id=task.id
			GROUP BY
			task.status,course_name
		</sql>
		<title>Tasks by Status &amp; Course </title>
	</reports>

	<!-- TBD <!- - Task report for creative admin - -> <reports id="2" type_of_report="table"> <column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" /> <column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" /> <column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" /> <column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" /> <column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" /> <column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" /> <column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" 
		name="status" /> <sql> </sql> <title>Task report</title> </reports> -->
	<!-- Published media for creative admin -->
	<reports id="3" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />
		<!-- <column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" /> -->

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='PUBLISHED'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Tasks Published</title>
	</reports>

	<!-- Inprogress task list for creative admin -->
	<reports id="4" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='DRAFT'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks in progress</title>
	</reports>

	<!-- Pending for review media list for content admin -->
	<reports id="5" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='COMPLETED'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Tasks Pending Review</title>
	</reports>

	<!-- Assigned task list for creative admin -->
	<reports id="6" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="type" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			A.item_type as type,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='CREATIVE_ASSIGNED'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description,  AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks in assigned state</title>
	</reports>

	<!-- Themes list for creative admin -->
	<reports id="7" type_of_report="table">
		<column columnHandler="NONE" display_name="Theme ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Theme Name" isVisible="true" name="name" />
		<column columnHandler="THEME" display_name="Action" isVisible="true" name="action" />

		<sql>select T.id as task_id, T.name as name, T.name as action
			from ui_theme T
			where T.id > 0
			ORDER BY task_id
		</sql>
		<title>Existing theme list</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

	<!-- Content Admin -->
	<reports id="20" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT content_admin.name, count(*) FROM public.task, public.content_admin WHERE task.actor_id = content_admin.id group by content_admin.name</sql>
		<title>My Name is CONTENT admin </title>
	</reports>
	<reports id="21" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.content_admin WHERE task.actor_id = content_admin.id group by task.status</sql>
		<title>My Name is content ADMIN</title>
	</reports>

	<!-- Task report for content admin -->
	<reports id="22" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN d.email IS NULL THEN 'Not Assigned' ELSE d.email  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title, M.module_name,
			CC.course_name
			ORDER BY a.id
		</sql>
		<title>Task report</title>
	</reports>

	<!-- Created lesson list for content admin -->
	<reports id="23" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Session Id" isVisible="true" name="session_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Status" isVisible="true" name="status" />
		<column columnHandler="TASK_HISTORY" display_name="Task History" isVisible="true" name="task_id" />
		<column columnHandler="STATUS_HANDLER" display_name="Action" isVisible="true" name="status" />
		
		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.id as session_id, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN D.email IS NOT NULL THEN D.email WHEN DD.email IS NOT NULL THEN DD.email ELSE 'Not Assigned'  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.creative_creator DD ON (DD.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.item_type ='LESSON' AND A.status!='DELETED'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title, CM.id,dd.email,
			M.module_name, CC.course_name, A.status
			ORDER BY a.id
		</sql>
		<title> All Tasks Created</title>
	</reports>

	<!-- Inprogress lesson list for content admin -->
	<reports id="24" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
			<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN d.email IS NULL THEN 'Not Assigned' ELSE d.email  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'DRAFT' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title,
			M.module_name, CC.course_name, A.status
			ORDER BY a.id
		</sql>
		<title> All Tasks in progress</title>
	</reports>

	<!-- Completed lesson list for content admin -->
	<reports id="25" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id, L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN d.email IS NULL THEN 'Not Assigned' ELSE d.email  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'COMPLETED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title,
			M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks completed</title>
	</reports>

	<!-- Review pending lesson list for content admin -->
	<reports id="26" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN d.email IS NULL THEN 'Not Assigned' ELSE d.email  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'COMPLETED' AND A.item_type ='LESSON' and B.status='REVIEWER_ASSIGNED'
			GROUP BY A.ID,L.id, d.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Pending Review</title>
	</reports>

	<!-- Requested to publish lesson list for content admin -->
	<reports id="27" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN D.email IS NOT NULL THEN D.email WHEN DD.email IS NOT NULL THEN DD.email ELSE 'Not Assigned'  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.creative_creator DD ON (DD.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'REQUEST_FOR_PUBLISH' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title,dd.email,
			CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks not Published</title>
	</reports>

	<!-- Published lesson list for content admin -->
	<reports id="28" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="LESSON_LINK_HANDLER" display_name="Preview" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN D.email IS NOT NULL THEN D.email WHEN DD.email IS NOT NULL THEN DD.email ELSE 'Not Assigned'  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.creative_creator DD ON (DD.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'PUBLISHED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id,d.email, L.title, CM.title,dd.email,
			M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Published</title>
	</reports>

	<!-- Assigned task list for content admin -->
	<reports id="29" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN d.email IS NULL THEN 'Not Assigned' ELSE d.email  END) as  actor, 
			( CASE  WHEN array_to_string(array_agg(C.name), ', ')='' then 'Not Assigned'
			ELSE array_to_string(array_agg(C.name), ', ')  END)  as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'CONTENT_ASSIGNED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title,
			M.module_name, CC.course_name,A.actor_id
			ORDER BY a.id
		</sql>
		<title> All Lessons in assigned state</title>
	</reports>

	<!-- Course list for content admin -->
	<reports id="30" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_title" />
		<column columnHandler="NONE" display_name="Modules" isVisible="true" name="module_count" />
		<column columnHandler="NONE" display_name="Sessions" isVisible="true" name="session_count" />
		<column columnHandler="NONE" display_name="Lessons" isVisible="true" name="lesson_count" />
		<column columnHandler="NONE" display_name="Published Lessons" isVisible="true" name="published_lesson_count" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>SELECT
	C . ID AS task_id,
	C .course_name AS course_title,
	COUNT (DISTINCT M) AS module_count,
	COUNT (DISTINCT S) AS session_count,
	COUNT (T) AS lesson_count,
	SUM (
		CASE
		WHEN T .status = 'PUBLISHED' THEN
			1
		ELSE
			0
		END
	) AS published_lesson_count
FROM
	course C
LEFT JOIN MODULE M ON C . ID = M .course_id
LEFT JOIN cmsession S ON S.module_id = M . ID
LEFT JOIN lesson L ON L.session_id = S. ID
LEFT JOIN task T ON T .item_id = L. ID
AND T .item_type = 'LESSON'
AND T .status != 'DELETED'
GROUP BY
	C . ID,
	course_title
ORDER BY
	task_id
		</sql>
		<title> Course list</title>
	</reports>

	<!-- Module list for content admin -->
	<reports id="31" type_of_report="table">
		<column columnHandler="NONE" display_name="Order" isVisible="true" name="order_id" />
		<column columnHandler="NONE" display_name="Module ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_title" />
		<column columnHandler="NONE" display_name="Sessions" isVisible="true" name="session_count" />
		<column columnHandler="NONE" display_name="Lessons" isVisible="true" name="lesson_count" />
		<column columnHandler="NONE" display_name="In Progress" isVisible="true" name="draft_lesson_count" />
		<column columnHandler="NONE" display_name="Published Lessons" isVisible="true" name="published_lesson_count" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>select M.order_id as order_id, M.id as task_id , M.module_name as module_title, count(DISTINCT S) as session_count, count(T) as lesson_count,  sum(case when T.status = 'PUBLISHED' then 1 else 0 end) as published_lesson_count,  sum(case when T.status = 'DRAFT' then 1 else 0 end) as draft_lesson_count
			from  module M
			left join cmsession S on S.module_id=M.id 
			left join lesson L on L.session_id=S.id
			left join task T on T.item_id=L.id and T.item_type='LESSON' and T.status!='DELETED' 
			where M.course_id=:course_id
			GROUP BY
	m.id
			order by order_id
		</sql>
		<title> Module list</title>
	</reports>

	<!-- Session list for content admin -->
	<reports id="32" type_of_report="table">
		<column columnHandler="NONE" display_name="Order" isVisible="true" name="order_id" />
		<column columnHandler="NONE" display_name="Session ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Session Description" isVisible="true" name="description" />
		<column columnHandler="NONE" display_name="Lessons" isVisible="true" name="lesson_count" />
		<column columnHandler="NONE" display_name="In Progress" isVisible="true" name="draft_lesson_count" />
		<column columnHandler="NONE" display_name="Published Lessons" isVisible="true" name="published_lesson_count" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>select S.order_id as order_id, S.id as task_id , S.title as session_title, S.description as description, count(T) as lesson_count,  sum(case when T.status = 'PUBLISHED' then 1 else 0 end) as published_lesson_count,  sum(case when T.status = 'DRAFT' then 1 else 0 end) as draft_lesson_count
			from  cmsession S
			left join lesson L on L.session_id=S.id
			left join task T on T.item_id=L.id and T.item_type='LESSON' and T.status!='DELETED' 
			where S.module_id=:module_id
			group by S.order_id, s.id
			order by order_id
		</sql>
		<title> Session list</title>
	</reports>

	<!-- Lesson list for content admin -->
	<reports id="33" type_of_report="table">
		<column columnHandler="NONE" display_name="Order" isVisible="true" name="order_id" />
		<column columnHandler="NONE" display_name="Lesson ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Status" isVisible="true" name="status" />
		<column columnHandler="NONE" display_name="Lesson Type" isVisible="true" name="lesson_type" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>select DISTINCT T.id as task_id, L.order_id as order_id, T.status as status, L.title as lesson_title, (case when L.id = P.lesson_id then 'Presentation' when L.id=A.lesson_id then 'Assessment' when L.id=G.lesson_id then 'Game' else 'EMPTY' end) as lesson_type
			 from task T, lesson L 
			 left join presentaion P on P.lesson_id = L.id 
			 left join assessment A on A.lesson_id = L.id
			 left join game G on G.lesson_id = L.id
			 where T.item_id = L.id and T.item_type= 'LESSON' and T.status!='DELETED' and L.session_id = :session_id
			 order by order_id
		</sql>
		<title> Lesson list</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->



	<!-- Content Reviewer -->
	<reports id="40" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT content_reviewer.name, count(*) FROM public.task, public.content_reviewer WHERE task.actor_id = content_reviewer.id group by content_reviewer.name</sql>
		<title>My Name is CONTENT reviewer </title>
	</reports>
	<reports id="41" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.content_reviewer WHERE task.actor_id = content_reviewer.id group by task.status</sql>
		<title>My Name is content REVIEWER</title>
	</reports>

	<!-- Assigned lesson list for Content Reviewer -->
	<reports id="42" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Created by" isVisible="true" name="actor" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN D.email IS NOT NULL THEN D.email WHEN DD.email IS NOT NULL THEN DD.email ELSE 'Not Assigned'  END) as  actor, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.creative_creator DD ON (DD.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'COMPLETED' AND B.status LIKE 'REVIEWER_ASSIGNED' AND A.item_type ='LESSON' AND B.reviewer_id=:content_reviewer_id
			GROUP BY A.ID, L.id,d.email,dd.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Assigned</title>
	</reports>

	<!-- Disapproved lesson list for Content Reviewer -->
	<reports id="43" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="actor" />
		<!-- <column columnHandler="NONE" display_name="Status" isVisible="true" name="status" /> -->

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE  WHEN D.email IS NOT NULL THEN D.email WHEN DD.email IS NOT NULL THEN DD.email ELSE 'Not Assigned'  END) as  actor
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.creative_creator DD ON (DD.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			B.status LIKE 'DIS_APPROVED' AND A.item_type ='LESSON' AND B.reviewer_id=:content_reviewer_id
			GROUP BY A.ID, L.id,d.email, L.title, CM.title, M.module_name,dd.email,
			CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Disapproved</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<!-- Creative creator -->
	<reports id="60" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT creative_creator.name, count(*) FROM public.task, public.creative_creator WHERE task.actor_id = creative_creator.id group by creative_creator.name</sql>
		<title>My Name is Creative Creator </title>
	</reports>
	<reports id="61" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.creative_creator WHERE task.actor_id = creative_creator.id group by task.status</sql>
		<title>My Name is Creative Creatorrrrrrr</title>
	</reports>

	<!-- Assigned media task list for creative creator -->
	<reports id="62" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>





SELECT DISTINCT
	A . ID AS task_id,
	A .item_type AS item_type,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.title
		WHEN 'VIDEO' THEN
			V.title
		WHEN 'LESSON' THEN
			'none'
		END
	) AS title,
	CM.title AS session_title,
	A .status AS status,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.description
		WHEN 'VIDEO' THEN
			V.description
		WHEN 'LESSON' THEN
			'none'
		END
	) AS description
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .image I ON (A .item_id = I. ID)
LEFT JOIN PUBLIC .video V ON (A .item_id = V. ID),
 PUBLIC .cmsession CM
WHERE
	A .status LIKE '%ASSIGNED'
AND A .actor_id = :creative_creator_id
AND CM. ID = CASE
WHEN A .item_type = 'IMAGE' THEN
	I.session_id
WHEN A .item_type = 'VIDEO' THEN
	V.session_id

END 
ORDER BY
	A . ID	</sql>
		<title> All Media Tasks Assigned</title>
	</reports>

	<!-- Inprogess media task list for creative creator -->
	<reports id="63" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>
		
		SELECT DISTINCT
	A . ID AS task_id,
	A .item_type AS item_type,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.title
		WHEN 'VIDEO' THEN
			V.title
		WHEN 'LESSON' THEN
			'none'
		END
	) AS title,
	CM.title AS session_title,
	A .status AS status,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.description
		WHEN 'VIDEO' THEN
			V.description
		WHEN 'LESSON' THEN
			'none'
		END
	) AS description
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .image I ON (A .item_id = I. ID)
LEFT JOIN PUBLIC .video V ON (A .item_id = V. ID),
 PUBLIC .cmsession CM
WHERE
	A.status='DRAFT'
AND A .actor_id = :creative_creator_id
AND CM. ID = CASE
WHEN A .item_type = 'IMAGE' THEN
	I.session_id
WHEN A .item_type = 'VIDEO' THEN
	V.session_id
END 
ORDER BY
	A . ID
		</sql>
		<title> All Media Tasks in Progress</title>
	</reports>

	<!-- Not reviewed media task list for creative creator -->
	<reports id="64" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="NONE" display_name="status" isVisible="false" name="status" />

		<sql>SELECT DISTINCT
	A . ID AS task_id,
	A .item_type AS item_type,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.title
		WHEN 'VIDEO' THEN
			V.title
		WHEN 'LESSON' THEN
			LL.title
		END
	) AS title,
	CM.title AS session_title,
	A .status AS status,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.description
		WHEN 'VIDEO' THEN
			V.description
		WHEN 'LESSON' THEN
			LL.title
		END
	) AS description
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .image I ON (A .item_id = I. ID)
LEFT JOIN PUBLIC .video V ON (A .item_id = V. ID)
LEFT JOIN PUBLIC .lesson LL ON (A .item_id = LL. ID),
 PUBLIC .cmsession CM
WHERE
	A.status='COMPLETED'
AND A .actor_id = :creative_creator_id
AND CM. ID = CASE
WHEN A .item_type = 'IMAGE' THEN
	I.session_id
WHEN A .item_type = 'VIDEO' THEN
	V.session_id
WHEN A .item_type = 'LESSON' THEN
	LL.session_id
END 
ORDER BY
	A . ID
		</sql>
		<title> All Media Tasks Pending Review</title>
	</reports>

	<!-- Disapproved media task list for creative creator -->
	<reports id="65" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>
		SELECT
	A . ID AS task_id,
	A .item_id AS item_id,
	A .status AS status,
	A .item_type AS item_type,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.title
		WHEN 'VIDEO' THEN
			V.title
		ELSE
			'none'
		END
	) AS title,
	A .status AS status11,
	CM.title AS session_title,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.description
		WHEN 'VIDEO' THEN
			V.description
		ELSE
			'none'
		END
	) AS description,
	D. NAME AS created_by
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .media_review M ON (M .task_id = A . ID)
LEFT JOIN PUBLIC .content_creator D ON (D. ID = A .owner_id)
LEFT JOIN PUBLIC .creative_admin AD ON (A .actor_id = AD. ID)
LEFT JOIN PUBLIC .creative_creator CR ON (CR. ID = A .actor_id)
LEFT JOIN PUBLIC .image I ON (A .item_id = I. ID)
LEFT JOIN PUBLIC .video V ON (A .item_id = V. ID),
PUBLIC .cmsession CM
WHERE
	A .status = 'DIS_APPROVED'
AND A .actor_id = :creative_creator_id
 AND CM. ID = CASE
WHEN A .item_type = 'IMAGE' THEN
	I.session_id
WHEN A .item_type = 'VIDEO' THEN
	V.session_id
END 
ORDER BY
	A . ID
		</sql>
		<title> All Media Tasks Disapproved</title>
	</reports>

	<!-- Approved media task list for creative creator -->
	<reports id="66" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		

		<sql>
		SELECT
	A . ID AS task_id,
	A .item_id AS item_id,
	A .status AS status,
	A .item_type AS item_type,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.title
		WHEN 'VIDEO' THEN
			V.title
		ELSE
			'none'
		END
	) AS title,
	A .status AS status11,
	CM.title AS session_title,
	(
		CASE A .item_type
		WHEN 'IMAGE' THEN
			I.description
		WHEN 'VIDEO' THEN
			V.description
		ELSE
			'none'
		END
	) AS description,
	(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
	D. NAME AS created_by
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .media_review M ON (M .task_id = A . ID)
LEFT JOIN PUBLIC .content_creator D ON (D. ID = A .owner_id)
LEFT JOIN PUBLIC .creative_admin AD ON (A .actor_id = AD. ID)
LEFT JOIN PUBLIC .creative_creator CR ON (CR. ID = A .actor_id)
LEFT JOIN PUBLIC .image I ON (A .item_id = I. ID)
LEFT JOIN PUBLIC .video V ON (A .item_id = V. ID),
PUBLIC .cmsession CM
WHERE
	A .status = 'COMPLETED'
AND A .actor_id = :creative_creator_id
 AND CM. ID = CASE
WHEN A .item_type = 'IMAGE' THEN
	I.session_id
WHEN A .item_type = 'VIDEO' THEN
	V.session_id

END 
ORDER BY
	A . ID
		</sql>
		<title> All Media Tasks Approved</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<!-- Content Creator -->
	<reports id="80" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT content_creator.name, count(*) FROM public.task, public.content_creator WHERE task.actor_id = content_creator.id group by content_creator.name</sql>
		<title>Title</title>
	</reports>
	<reports id="81" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.content_creator WHERE task.actor_id = content_creator.id group by task.status</sql>
		<title>TITLE</title>
	</reports>

	<!-- Assigned lesson list for content creator -->
	<reports id="82" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name, array_to_string(array_agg(C.name), ', ') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'CONTENT_ASSIGNED' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id,
			d.email, L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Assigned </title>
	</reports>

	<!-- Inprogress lesson list for content creator -->
	<reports id="83" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			array_to_string(array_agg(C.name), ', ') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'DRAFT' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id, d.email, L.title,
			CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks in Progress</title>
	</reports>

	<!-- Disapproved lesson list for content creator -->
	<reports id="84" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name, array_to_string(array_agg(C.name), ', ') as reviewers,A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'DIS_APPROVED' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id, d.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Disapproved</title>
	</reports>

	<!-- Approved lesson list for content creator -->
	<reports id="85" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name, array_to_string(array_agg(C.name), ', ') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'APPROVED' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id, d.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Approved</title>
	</reports>

	<!-- Created media list for content creator -->
	<reports id="86" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />

		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as Actor
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id)
			LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id)
			LEFT JOIN public.creative_creator CR ON (CR.id=A.actor_id)
			LEFT JOIN
			public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.owner_id=:content_creator_id
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title, I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks created</title>
	</reports>

	<!-- Published lesson list for content creator -->
	<reports id="87" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="LESSON_LINK_HANDLER" display_name="Preview" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ', ') as reviewers
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'PUBLISHED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id,d.email, L.title, CM.title,
			M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Published</title>
	</reports>
	
	<reports id="88" type_of_report="table">
		<column columnHandler="NONE" display_name="LO ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Type of LO" isVisible="true" name="obj_type" />
		<column columnHandler="NONE" display_name="LO" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Subject" isVisible="true" name="subject" />

		<column columnHandler="LO_LINK_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>select id as task_id, obj_type, title, subject from learning_objective
		</sql>
		<title> All Learning Objectives</title>
	</reports>
	
	<reports id="89" type_of_report="table">
		<column columnHandler="NONE" display_name="#" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Title" isVisible="true" name="assessmenttitle" />
		<column columnHandler="NONE" display_name="Type" isVisible="true" name="assessment_type" />
		<column columnHandler="ASSESSMENT" display_name="Action" isVisible="true" name="status" />
		
		<sql>select id as task_id, assessment_type, assessmenttitle from assessment
		</sql>
		<title> All assessments</title>
	</reports>
	
	<reports id="90" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" isVisible="true" name="cid" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="mid" />
		<column columnHandler="NONE" display_name="Session ID" isVisible="true" name="cmid" />
		<column columnHandler="NONE" display_name="Lesson ID" isVisible="true" name="lid" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="title" isVisible="true" name="title" />
		
		
		<sql>SELECT C.id AS cid,
       M.id AS mid,
       CM.id AS cmid,
       L.id AS lid,
       C.course_name,
       M.module_name,
       L.title
FROM course C,
     cmsession CM,
     module M,
     lesson L,
     task T,
     student S,
     batch_group BG,
     batch_students BS,
     batch_course BC
WHERE C.id = M.course_id
  AND M.id = CM.module_id
  AND CM.id = L.session_id
  AND L.id=T.item_id
  AND T.item_type='LESSON'
  AND T.status='PUBLISHED'
  AND S.istar_authorization_token = :istar_authorization_token
  AND BC.course_id=C.id
  AND BC.batch_group_id=BG.id
  AND BS.student_id= S.id
  AND BS.batch_group_id=BG.id

		</sql>
		<title> Course List</title>
	</reports>
	
	<reports id="91" type_of_report="table">
		<column columnHandler="NONE" display_name="LO ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="LO" isVisible="true" name="lo_title" />
		<column columnHandler="NONE" display_name="Subject" isVisible="true" name="lo_subject" />
		<column columnHandler="NONE" display_name="Lessons attached" isVisible="true" name="lesson_list" />
		<column columnHandler="NONE" display_name="Sessions attached" isVisible="true" name="session_list" />

		<sql>SELECT DISTINCT
	lo. ID AS task_id,
	lo.title AS lo_title,
	(
		CASE
		WHEN lo.subject IS NULL THEN
			'NONE'
		ELSE
			lo.subject
		END
	) AS lo_subject,
	(
		CASE
		WHEN string_agg (l.title, ',') IS NULL THEN
			'NONE'
		ELSE
			string_agg (l.title, ',')
		END
	) AS lesson_list,
	(
		CASE
		WHEN C .title IS NULL THEN
			'NONE'
		ELSE
			C .title
		END
	) AS session_list
FROM
	learning_objective lo
LEFT JOIN learning_objective_lesson lol ON lol.learning_objectiveid = lo. ID
LEFT JOIN lesson l ON l. ID = lol.lessonid
LEFT JOIN cmsession C ON C . ID = l.session_id
WHERE
	lo. ID NOT IN (
		SELECT
			le_ob_le.learning_objectiveid
		FROM
			learning_objective_lesson le_ob_le
		WHERE
			le_ob_le.lessonid = :lesson_id
	)
GROUP BY
	lo_title,
	task_id,
	lo_subject,
	session_list
ORDER BY
	task_id
		</sql>
		<title> List of Learning Objectives for lesson</title>
	</reports>
	
	
	<reports id="92" type_of_report="table">
		<column columnHandler="NONE" display_name="LO ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="LO" isVisible="true" name="lo_title" />
		<column columnHandler="NONE" display_name="Subject" isVisible="true" name="lo_subject" />
		<column columnHandler="NONE" display_name="Lessons attached" isVisible="true" name="lesson_list" />
		<column columnHandler="NONE" display_name="Sessions attached" isVisible="true" name="session_list" />

		<sql>SELECT DISTINCT
	lo. ID AS task_id,
	lo.title AS lo_title,
	(
		CASE
		WHEN lo.subject IS NULL THEN
			'NONE'
		ELSE
			lo.subject
		END
	) AS lo_subject,
	(
		CASE
		WHEN string_agg (l.title, ',') IS NULL THEN
			'NONE'
		ELSE
			string_agg (l.title, ',')
		END
	) AS lesson_list,
	(
		CASE
		WHEN C .title IS NULL THEN
			'NONE'
		ELSE
			C .title
		END
	) AS session_list
FROM
	learning_objective lo
LEFT JOIN learning_objective_lesson lol ON lol.learning_objectiveid = lo. ID
LEFT JOIN lesson l ON l. ID = lol.lessonid
LEFT JOIN cmsession C ON C . ID = l.session_id
WHERE
	lo. ID NOT IN (
		SELECT
			le_ob_qu.learning_objectiveid
		FROM
			learning_objective_question le_ob_qu
		WHERE
			le_ob_qu.questionid = :question_id
	)
GROUP BY
	lo_title,
	task_id,
	lo_subject,
	session_list
ORDER BY
	task_id
		</sql>
		<title> List of Learning Objectives for question</title>
	</reports>
	
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<!-- Trainer -->
	<!-- Trainer list -->
	<reports id="100" type_of_report="table">
		<column columnHandler="NONE" display_name="Trainer ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Name" isVisible="true" name="name" />
		<column columnHandler="NONE" display_name="Gender" isVisible="true" name="gender" />
		<column columnHandler="NONE" display_name="E-Mail" isVisible="true" name="email" />
		<column columnHandler="TRAINER" display_name="Status" isVisible="true" name="status" />

		<sql>select id as task_id, name as name, gender as gender, email as email 
			from trainer 
			ORDER BY task_id
		</sql>
		<title> Trainer list </title>
	</reports>
	
	<!-- Trainer Assessment list -->
	<reports id="101" type_of_report="table">
		<column columnHandler="NONE" display_name="Trainer ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Assessment Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Questions" isVisible="true" name="question_count" />
		<column columnHandler="TRAINER" display_name="Score" isVisible="true" name="status" />
		
		<sql>select T.id as task_id, A.assessmenttitle as title, A.number_of_questions as question_count, (CASE WHEN R.score IS NULL THEN 'PENDING' ELSE R.score||'' END) as status
			from assessment A, event  E, assessment_event  AE
		  		 LEFT JOIN trainer T on (T.id = :trainer_id)
				 LEFT JOIN report  R on (R.assessment_id = AE.assessment and R.user_id = T.id)
			where AE.event_id = E.id and
      			 AE.assessment = A.id and
      			 E.actor_id = :trainer_id
      		order by T.id
		</sql>
		<title> Trainer list </title>
	</reports>
	
	<!-- Trainer Assessment Report -->
	<reports id="102" type_of_report="table">
		<column columnHandler="NONE" display_name="Question" isVisible="true" name="question" />
		<column columnHandler="NONE" display_name="Result" isVisible="true" name="is_correct" />
		<column columnHandler="NONE" display_name="Selected Options" isVisible="true" name="selected_options" />
		<column columnHandler="NONE" display_name="Correct Options" isVisible="true" name="correct_options" />

		<sql>
SELECT 

A.assessmenttitle as assessment_title,
(
CASE SA.correct 
WHEN 'f' THEN 'incorrect'
ELSE 'correct'
END
) is_correct,

(
CASE SA.option1
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 0))
ELSE ''
END
)
||
(
CASE SA.option2
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 1))
ELSE ''
END
) 
||
(
CASE SA.option3
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 2))
ELSE ''
END
)
||
(
CASE SA.option4
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 3))
ELSE ''
END
)
||
(
CASE SA.option5
WHEN 't' THEN ((SELECT AO.text as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 4))
ELSE ''
END
)as selected_options,

(SELECT
string_agg(AOO.text,', ')

FROM  assessment_option AOO

WHERE AOO.marking_scheme=1
AND AOO.question_id=SA.question_id

) as correct_options,
Q.question_text as question

FROM student_assessment SA, question Q, assessment A
WHERE SA.student_id= :trainer_id
AND Q.id = SA.question_id
AND SA.assessment_id = :assessment_id
		</sql>
		<title> Trainer Assessment Report</title>
	</reports>
	
	
	<reports id="150" type_of_report="table">
		<column columnHandler="NONE" display_name="Handout ID" isVisible="true" name="handout_id" />
		<column columnHandler="NONE" display_name="Lesson" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module" isVisible="true" name="module_title" />
		<column columnHandler="NONE" display_name="Course" isVisible="true" name="course_title" />
		<column columnHandler="HANDOUT_HANDLER" display_name="Edit" isVisible="true" name="handout_id" />

		<sql>
		select DISTINCT s.title as session_title, m.module_name as module_title, c.course_name as course_title, ll.title as lesson_title, ll.id as lesson_id , hh.title as handout_title,  hh.id as handout_id , hh.handout_text as handout_data
from handouts hh, lesson ll , cmsession s, module m , course c
where hh.lesson_id=ll.id  and s.id = ll.session_id and m.id=s.module_id and c.id=m.course_id

		
		</sql>
		<title> All Handouts</title>
	</reports>
	
	
	<reports id="151" type_of_report="table">
		<column columnHandler="NONE" display_name="Company ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Company Name" isVisible="true" name="company_name" />
		<column columnHandler="VACANCY_HANDLER" display_name="Vacancies" isVisible="true" name="task_id" /> 
		<sql>
		select id as task_id, name as company_name from recruiter_company;
		</sql>
		<title> All Companies</title>
	</reports>
	
	<reports id="152" type_of_report="table">
		
			<column columnHandler="NONE" display_name="JD ID"  is_updatetable="false" isVisible="true" name="id" />
			   
		<column columnHandler="NONE" display_name="profile_title" is_updatetable="true" isVisible="true" name="profile_title" />
		<column columnHandler="NONE" display_name="location" is_updatetable="true" isVisible="true" name="location" />
		<column columnHandler="NONE" display_name="description" is_updatetable="true" isVisible="true" name="description" />
		<column columnHandler="EDIT_DELETE_HANDLER" display_name="Edit" is_updatetable="false"  isVisible="true" name="id" />
	<table_name>
		 vacancy
		</table_name>
		<sql>select id ,  profile_title, location, description  from vacancy where company_id=:company_id</sql>
		<update_sql>
		SELECT distinct RC.id as task_id, 
RC.name as company_name,
V.profile_title as jd_title,
V.location as jd_location,
V.description as jd_description
FROM
	recruiter_company RC,
	vacancy V
WHERE
RC.id = V.company_id
AND V.id =:id
		</update_sql>
		<title> All Vacancies</title>
	</reports>
	
	<reports id="153" type_of_report="table">
		<column columnHandler="NONE" display_name="JD ID" is_updatetable="false" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Company Name" is_updatetable="false" isVisible="true" name="company_name" />
		<column columnHandler="NONE" display_name="JD Title" is_updatetable="true" isVisible="true" name="jd_title" />
		<column columnHandler="NONE" display_name="JD Location" is_updatetable="true" isVisible="true" name="jd_location" />
		<column columnHandler="NONE" display_name="JD Description" is_updatetable="true" isVisible="true" name="jd_description" />
		<!-- <column columnHandler="EDIT_DELETE_HANDLER" display_name="Edit" is_updatetable="" isVisible="true" name="task_id" /> -->
		<sql>
		SELECT distinct RC.id as task_id, 
RC.name as company_name,
V.profile_title as jd_title,
V.location as jd_location,
V.description as jd_description
FROM
	recruiter_company RC,
	vacancy V
WHERE
RC.id = V.company_id
AND V.id =:id
		</sql>
		<title> Edit Vacancy</title>
	</reports>
	
	
	<!--  DOubt List  -->
	
	<reports id="159" type_of_report="table">
		<column columnHandler="NONE" display_name="JD ID" is_updatetable="false" isVisible="true" name="id" />
		<column columnHandler="NONE" display_name="Student Email " is_updatetable="false" isVisible="true" name="student_email" />
		<column columnHandler="NONE" display_name="Orgnaization Name" is_updatetable="true" isVisible="true" name="organization_email" />
		<column columnHandler="NONE" display_name="Quesstion" is_updatetable="true" isVisible="true" name="dquestion" />
		<column columnHandler="NONE" display_name="Answer" is_updatetable="true" isVisible="true" name="danswer" />
		<column columnHandler="ANSWER_DOUBT" display_name="Edit" is_updatetable="" isVisible="true" name="task_id" />
		<sql>
		SELECT
	DISTINCT d. ID AS id,
	s.email AS student_email,
	o. NAME AS organization_email,
	d.question AS dquestion,
	d.answer danswer,  d. ID task_id
FROM
	doubt d,
	student s,
	organization o, 
  content_creator cc
WHERE
	s. ID = d.student_id
AND s.organization_id = o.ID


		</sql>
		<title>View Doubts by Students</title>
	</reports>
	<reports id="161" type_of_report="table">
		<column columnHandler="NONE" display_name="dates" is_updatetable="false" isVisible="true" name="dates" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
CAST (task_log.created_at as date) as dates,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log
GROUP BY CAST (task_log.created_at as date)

		</sql>
		<title>Date Wise Data</title>
	</reports>
	<reports id="162" type_of_report="table">
			<column columnHandler="PerCursePerDateHandler" display_name="id" is_updatetable="false" isVisible="true" name="id" />
	
		<column columnHandler="NONE" display_name="COURSE" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
					<column columnHandler="NONE" display_name="id" is_updatetable="false" isVisible="true" name="task_id" />
		
		<sql>
		SELECT
			C.id, C.course_name,
count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved, C.id as task_id
 
FROM
   task_log TL, lesson L , cmsession CM, module M , course C  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
GROUP BY C.id,C.course_name

		</sql>
		<title>Course Wise Data</title>
	</reports>
	<reports id="163" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" is_updatetable="false" isVisible="true" name="id" />
		<column columnHandler="NONE" display_name="COURSE" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Session ID" is_updatetable="false" isVisible="true" name="cm_id" />
		<column columnHandler="NONE" display_name="SESSION" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
			C.id , C.course_name, CM.id as cm_id, CM.title as cmtitle,
count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
GROUP BY C.ID, cm_id

		</sql>
		<title>Session Wise Data</title>
	</reports>
	<reports id="164" type_of_report="table">
		<column columnHandler="LogActorHandler" display_name="id" is_updatetable="false" isVisible="true" name="id" />
		<column columnHandler="NONE" display_name="Email" is_updatetable="false" isVisible="true" name="email" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<column columnHandler="NONE" display_name="id" is_updatetable="false" isVisible="true" name="task_id" />
		
		<sql>
	SELECT
			CA.id as id , CA.email,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved, CA.id as task_id
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_admin CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id

GROUP BY  CA.email , CA.id
order by   CA.email 

		</sql>
		<title>content admin Data</title>
	</reports>
	<reports id="165" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" is_updatetable="false" isVisible="true" name="email" />
		<column columnHandler="NONE" display_name="COURSE" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Session ID" is_updatetable="false" isVisible="true" name="cm_id" />
		<column columnHandler="NONE" display_name="SESSION" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
	SELECT
			CA.email, C.course_name, CM.id as cm_id, CM.title as cmtitle,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_creator CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id

GROUP BY  CA.email, C.course_name ,cm_id
order by   CA.email, C.course_name ,cm_id

		</sql>
		<title>content creator Data</title>
	</reports>
	<reports id="166" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" is_updatetable="false" isVisible="true" name="email" />
		<column columnHandler="NONE" display_name="COURSE" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Session ID" is_updatetable="false" isVisible="true" name="cm_id" />
		<column columnHandler="NONE" display_name="SESSION" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
	SELECT
			CA.email, C.course_name, CM.id as cm_id, CM.title as cmtitle,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, creative_admin CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id

GROUP BY  CA.email, C.course_name ,cm_id
order by   CA.email, C.course_name ,cm_id

		</sql>
		<title>creative_admin Data</title>
	</reports>
	<reports id="167" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" is_updatetable="false" isVisible="true" name="email" />
		<column columnHandler="NONE" display_name="COURSE" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Session ID" is_updatetable="false" isVisible="true" name="cm_id" />
		<column columnHandler="NONE" display_name="SESSION" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
	SELECT
			CA.email, C.course_name, CM.id as cm_id, CM.title as cmtitle,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, creative_creator CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id

GROUP BY  CA.email, C.course_name ,cm_id
order by   CA.email, C.course_name ,cm_id

		</sql>
		<title>creative_creator Data</title>
	</reports>
		<reports id="168" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" is_updatetable="false" isVisible="true" name="email" />
		<column columnHandler="NONE" display_name="COURSE" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Session ID" is_updatetable="false" isVisible="true" name="cm_id" />
		<column columnHandler="NONE" display_name="SESSION" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
	SELECT
			CA.email, C.course_name, CM.id as cm_id, CM.title as cmtitle,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_reviewer CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id

GROUP BY  CA.email, C.course_name ,cm_id
order by   CA.email, C.course_name ,cm_id

		</sql>
		<title>Content Reviewer Data</title>
	</reports>
	
	
	<reports id="169" type_of_report="table">
		<column columnHandler="NONE" display_name="Dates" is_updatetable="false" isVisible="true" name="dates" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
	SELECT
			 CAST (TL.created_at as date) as dates,
count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and C.id =:course_id
GROUP BY CAST (TL.created_at as date) 

		</sql>
		<title>Course Per Day Data</title>
	</reports>
	
	<reports id="170" type_of_report="line">
		<column columnHandler="NONE" display_name="Dates" is_updatetable="false" isVisible="true" name="dates" />
		
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
	SELECT
			 CAST (TL.created_at as date) as dates,
count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and C.id =:course_id
GROUP BY CAST (TL.created_at as date) 

		</sql>
		<title>Content Reviewer Data</title>
	</reports>
	
	<reports id="171" type_of_report="table">
		<column columnHandler="NONE" display_name="Session ID" is_updatetable="false" isVisible="true" name="cm_id" />
		<column columnHandler="NONE" display_name="SESSION" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
			CM.id as cm_id, CM.title as cmtitle,
count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and C.id = :course_id
GROUP BY cm_id


		</sql>
		<title>Session Wise Data</title>
	</reports>
	<reports id="172" type_of_report="table">
		<column columnHandler="NONE" display_name="Dates" is_updatetable="false" isVisible="true" name="dates" />
		
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
			CAST (TL.created_at as date) as dates,  
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved, CA.id as task_id
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_admin CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id
and CA.id =  :actor_id
GROUP BY  CAST (TL.created_at as date), CA.id


		</sql>
		<title>Content Admin Per Day</title>
	</reports>
	
	
	<reports id="173" type_of_report="line">
		<column columnHandler="NONE" display_name="Dates" is_updatetable="false" isVisible="true" name="dates" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
			CAST (TL.created_at as date) as dates,  
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved, CA.id as task_id
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_admin CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id
and CA.id =  :actor_id
GROUP BY  CAST (TL.created_at as date), CA.id


		</sql>
		<title>Content Admin Per Day</title>
	</reports>
	
	<reports id="174" type_of_report="table">
		<column columnHandler="NONE" display_name="id" is_updatetable="false" isVisible="true" name="id" />
		<column columnHandler="NONE" display_name="course_name" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="PerCoursePerActorHandler" display_name="Sessions" is_updatetable="false" isVisible="true" name="actor_id" />
		
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
		  C.id  as id, C.course_name,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved, 'CONTENT_ADMIN;;'||CA.id  as actor_id
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_admin CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and CA.id = TL.actor_id
and CA.id =  :actor_id
GROUP BY  C.id , C.course_name, CA.id
order by C.course_name

		</sql>
		<title>Content Admin Per Course</title>
	</reports>
	
	<reports id="175" type_of_report="table">
		<column columnHandler="NONE" display_name="id" is_updatetable="false" isVisible="true" name="id" />
		<column columnHandler="NONE" display_name="cmtitle" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="PerSessionPerActorHandler" display_name="Sessions" is_updatetable="false" isVisible="true" name="actor_id" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		
		<sql>
		SELECT
		CM.id as id, CM.title as cmtitle,
		count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
		count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved,
'CONTENT_ADMIN;;'||CA.id  as actor_id
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_admin CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and C.id = :course_id
and CA.id =:user_id
and TL.actor_id=CA.id

GROUP BY CM.id, CA.id
order by CM.title

		</sql>
		<title>Content Admin Per Session</title>
	</reports>
	<reports id="176" type_of_report="table">
		<column columnHandler="NONE" display_name="id" is_updatetable="false" isVisible="true" name="id" />
		<column columnHandler="NONE" display_name="cmtitle" is_updatetable="false" isVisible="true" name="cmtitle" />
		<column columnHandler="PerSessionPerActorHandler" display_name="Sessions" is_updatetable="false" isVisible="true" name="actor_id" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		
		<sql>
		SELECT
		CM.id as id, CM.title as cmtitle,
		count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
		count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved,
'CONTENT_ADMIN;;'||CA.id  as actor_id
FROM
   task_log TL, lesson L , cmsession CM, module M , course C, content_admin CA  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
and C.id = :course_id
and CA.id =:user_id
and TL.actor_id=CA.id

GROUP BY CM.id, CA.id
order by CM.title

		</sql>
		<title>Content Admin Per Session</title>
	</reports>
	
	
	
	
	<reports id="199" type_of_report="line">
		<column columnHandler="NONE" display_name="dates" is_updatetable="false" isVisible="true" name="dates" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
CAST (task_log.created_at as date) as dates,
    count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log
GROUP BY CAST (task_log.created_at as date)

		</sql>
		<title>Date Wise Data</title>
	</reports>
	
	<reports id="200" type_of_report="line">

		<column columnHandler="NONE" display_name="COURSE" is_updatetable="false" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="CREATED" is_updatetable="false" isVisible="true" name="created" />
		<column columnHandler="NONE" display_name="CREATIVE_ASSIGNED" is_updatetable="true" isVisible="true" name="creative_assigned" />
		<column columnHandler="NONE" display_name="COMPLETED" is_updatetable="true" isVisible="true" name="completed" />
		<column columnHandler="NONE" display_name="CONTENT_ASSIGNED" is_updatetable="true" isVisible="true" name="content_assigned" />
		<column columnHandler="NONE" display_name="PUBLISHED" is_updatetable="" isVisible="true" name="published" />
		<column columnHandler="NONE" display_name="UNPUBLISHED" is_updatetable="false" isVisible="true" name="unpublished" />
		<column columnHandler="NONE" display_name="DRAFT" is_updatetable="true" isVisible="true" name="draft" />
		<column columnHandler="NONE" display_name="APPROVED" is_updatetable="true" isVisible="true" name="approved" />
		<column columnHandler="NONE" display_name="DELETED" is_updatetable="true" isVisible="true" name="deleted" />
		<column columnHandler="NONE" display_name="DIS_APPROVED" is_updatetable="" isVisible="true" name="dis_approved" />
		<sql>
		SELECT
			 C.course_name,
count(*) filter (where changed_status ='CREATED') as created,
		count(*) filter (where changed_status ='CREATIVE_ASSIGNED') as creative_assigned,
		count(*) filter (where changed_status ='COMPLETED') as completed,
    count(*) filter (where changed_status ='CONTENT_ASSIGNED') as content_assigned,
    count(*) filter (where changed_status ='PUBLISHED') as published,
		count(*) filter (where changed_status ='UNPUBLISHED') as unpublished,
    count(*) filter (where changed_status ='DRAFT') as draft,
    count(*) filter (where changed_status ='APPROVED') as approved,
    count(*) filter (where changed_status ='DELETED') as deleted,
 count(*) filter (where changed_status ='DIS_APPROVED') as dis_approved
FROM
   task_log TL, lesson L , cmsession CM, module M , course C  
 where C.id = M.course_id
and M.id = CM.module_id
and CM.id = L.session_id
and L.id = TL.item_id 
and TL.item_type='LESSON'
GROUP BY C.course_name

		</sql>
		<title>Course Wise Data Graph</title>
	</reports>
	
	<reports id="201" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name=" Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>SELECT DISTINCT
	A . ID AS task_id,
	A .item_type AS item_type,
	LL.title AS title,
	CM.title AS session_title,
	A .status AS status,
	LL.title AS description
FROM
	task A,
	lesson LL,
	cmsession CM
WHERE
A .status LIKE '%ASSIGNED'
AND A .actor_id = :creative_creator_id
AND CM. ID = LL.session_id
 and A .item_id = LL. ID
and A.item_type = 'LESSON'
ORDER BY
	A . ID</sql>
		<title> All Lesson Tasks Assigned</title>
	</reports>
	
	<reports id="202" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>SELECT DISTINCT
	A . ID AS task_id,
	A .item_type AS item_type,
	LL.title
	 AS title,
	CM.title AS session_title,
	A .status AS status,

			LL.title
	 AS description
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .lesson LL ON (A .item_id = LL. ID and A.item_type='LESSON'),
 PUBLIC .cmsession CM
WHERE
	A.status='DRAFT'
AND A .actor_id = :creative_creator_id
AND CM. ID = 
	LL.session_id
ORDER BY
	A . ID
		</sql>
		<title> All Lesson Tasks in Progress</title>
	</reports>
	
	<reports id="203" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>
		SELECT
	A . ID AS task_id,
	A .item_id AS item_id,
	A .status AS status,
	A .item_type AS item_type,
	LL.title AS title,
	A .status AS status11,
	CM.title AS session_title,
	LL.title AS description,
	D. NAME AS created_by
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .media_review M ON (M .task_id = A . ID)
LEFT JOIN PUBLIC .content_creator D ON (D. ID = A .owner_id)
LEFT JOIN PUBLIC .creative_admin AD ON (A .actor_id = AD. ID)
LEFT JOIN PUBLIC .creative_creator CR ON (CR. ID = A .actor_id)
LEFT JOIN PUBLIC .lesson LL ON (A .item_id = LL. ID),
 PUBLIC .cmsession CM
WHERE
	A .status = 'DIS_APPROVED'
AND A .actor_id = :creative_creator_id
AND CM. ID = LL.session_id
ORDER BY
	A . ID
		</sql>
		<title> All Lesson Tasks Disapproved</title>
	</reports>
	
	<reports id="204" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>
		SELECT
	A . ID AS task_id,
	A .item_id AS item_id,
	A .status AS status,
	A .item_type AS item_type,
	LL.title AS title,
	A .status AS status11,
	CM.title AS session_title,
	LL.title description,
	D. NAME AS created_by
FROM
	PUBLIC .task A
LEFT JOIN PUBLIC .content_creator D ON (D. ID = A .owner_id)
LEFT JOIN PUBLIC .creative_admin AD ON (A .actor_id = AD. ID)
LEFT JOIN PUBLIC .creative_creator CR ON (CR. ID = A .actor_id)
LEFT JOIN PUBLIC .lesson LL ON (A .item_id = LL. ID),
 PUBLIC .cmsession CM
WHERE
	A .status = 'APPROVED'
AND A .actor_id = :creative_creator_id
AND CM. ID = LL.session_id

ORDER BY
	A . ID
		</sql>
		<title> All Lesson Tasks Approved</title>
	</reports>
</istar_reports>