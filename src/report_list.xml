<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<istar_reports>

	<!-- Creative Admin -->
	<reports id="0" type_of_report="pie">

		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>SELECT
			course.course_name, COUNT (*)

			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id

			GROUP BY
			course.course_name
		</sql>
		<title>Tasks by Course</title>
	</reports>
	<reports id="1" type_of_report="pie">

		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="name" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>SELECT
			content_creator.name, COUNT (*)

			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id

			GROUP BY
			content_creator.name
		</sql>
		<title>Tasks by Assignee </title>
	</reports>
	
	<reports id="2" type_of_report="pie">

		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="status" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>
			SELECT
			task.status, COUNT (*)
		
			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id
		
			GROUP BY
			task.status
		</sql>
		<title>Tasks by Status </title>
	</reports>
	
	<reports id="100" type_of_report="column">
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="status" />
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="count" />
		<sql>SELECT
			course_name, task.status, COUNT (*)
			FROM
			task,
			content_creator,
			lesson, cmsession, "module", course, task_log
			WHERE
			task.actor_id = content_creator."id" and
			task.item_id=lesson."id"
			and lesson.session_id=cmsession."id"
			and cmsession.module_id="module"."id"
			and "module".course_id=course.id
			and task_log.task_id=task.id
			GROUP BY
			task.status,course_name
		</sql>
		<title>Tasks by Status &amp; Course </title>
	</reports>

	<!-- TBD <!- - Task report for creative admin - -> <reports id="2" type_of_report="table"> <column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" /> <column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" /> <column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" /> <column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" /> <column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" /> <column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" /> <column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" 
		name="status" /> <sql> </sql> <title>Task report</title> </reports> -->
	<!-- Published media for creative admin -->
	<reports id="3" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />
		<!-- <column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" /> -->

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='PUBLISHED'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Tasks Published</title>
	</reports>

	<!-- Inprogress task list for creative admin -->
	<reports id="4" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='DRAFT'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks in progress</title>
	</reports>

	<!-- Pending for review media list for content admin -->
	<reports id="5" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='COMPLETED'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Tasks Pending Review</title>
	</reports>

	<!-- Assigned task list for creative admin -->
	<reports id="6" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="type" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="assigned_to" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="created_by" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			A.item_type as type,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as assigned_to,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON
			(CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='CREATIVE_ASSIGNED'
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description,  AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks in assigned state</title>
	</reports>

	<!-- Themes list for creative admin -->
	<reports id="7" type_of_report="table">
		<column columnHandler="NONE" display_name="Theme ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Theme Name" isVisible="true" name="name" />
		<column columnHandler="THEME" display_name="Action" isVisible="true" name="action" />

		<sql>select T.id as task_id, T.name as name, T.name as action
			from ui_theme T
			ORDER BY task_id
		</sql>
		<title>Existing theme list</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

	<!-- Content Admin -->
	<reports id="20" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT content_admin.name, count(*) FROM public.task, public.content_admin WHERE task.actor_id = content_admin.id group by content_admin.name</sql>
		<title>My Name is CONTENT admin </title>
	</reports>
	<reports id="21" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.content_admin WHERE task.actor_id = content_admin.id group by task.status</sql>
		<title>My Name is content ADMIN</title>
	</reports>

	<!-- Task report for content admin -->
	<reports id="22" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers, A.status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title, M.module_name,
			CC.course_name
			ORDER BY a.id
		</sql>
		<title>Task report</title>
	</reports>

	<!-- Created lesson list for content admin -->
	<reports id="23" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Status" isVisible="true" name="status" />
		<column columnHandler="TASK_HISTORY" display_name="Task History" isVisible="true" name="task_id" />
		<column columnHandler="STATUS_HANDLER" display_name="Action" isVisible="true" name="status" />
		
		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.item_type ='LESSON' AND A.status!='DELETED'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title,
			M.module_name, CC.course_name, A.status
			ORDER BY a.id
		</sql>
		<title> All Tasks Created</title>
	</reports>

	<!-- Inprogress lesson list for content admin -->
	<reports id="24" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
			<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			( CASE d.email WHEN d.email THEN d.email 
			ELSE 'Not Assigned'
			END) as actor,array_to_string(array_agg(C.name), ',') as reviewers,A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'DRAFT' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title,
			M.module_name, CC.course_name, A.status
			ORDER BY a.id
		</sql>
		<title> All Tasks in progress</title>
	</reports>

	<!-- Completed lesson list for content admin -->
	<reports id="25" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id, L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers,A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'COMPLETED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title,
			M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks completed</title>
	</reports>

	<!-- Review pending lesson list for content admin -->
	<reports id="26" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'COMPLETED' AND A.item_type ='LESSON' and B.status='REVIEWER_ASSIGNED'
			GROUP BY A.ID,L.id, d.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Pending Review</title>
	</reports>

	<!-- Requested to publish lesson list for content admin -->
	<reports id="27" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'REQUEST_FOR_PUBLISH' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title,
			CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks not Published</title>
	</reports>

	<!-- Published lesson list for content admin -->
	<reports id="28" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="LESSON_LINK_HANDLER" display_name="Preview" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'PUBLISHED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id,d.email, L.title, CM.title,
			M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Published</title>
	</reports>

	<!-- Assigned task list for content admin -->
	<reports id="29" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers,A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'CONTENT_ASSIGNED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id, d.email, L.title, CM.title,
			M.module_name, CC.course_name,A.actor_id
			ORDER BY a.id
		</sql>
		<title> All Lessons in assigned state</title>
	</reports>

	<!-- Course list for content admin -->
	<reports id="30" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_title" />
		<column columnHandler="NONE" display_name="Modules" isVisible="true" name="module_count" />
		<column columnHandler="NONE" display_name="Sessions" isVisible="true" name="session_count" />
		<column columnHandler="NONE" display_name="Lessons" isVisible="true" name="lesson_count" />
		<column columnHandler="NONE" display_name="Published Lessons" isVisible="true" name="published_lesson_count" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>select C.id as task_id , C.course_name as course_title, count( DISTINCT M) as module_count, count(DISTINCT S) as session_count, count(L) as lesson_count,  sum(case when T.status = 'PUBLISHED' then 1 else 0 end) as published_lesson_count
from course C, module M
	left join cmsession S on S.module_id=M.id 
	left join lesson L on L.session_id=S.id
	left join task T on T.item_id=L.id
where C.id = M.course_id and T.item_type = 'LESSON' and T.status!='DELETED'
group by course_title, task_id
order by task_id

		</sql>
		<title> Course list</title>
	</reports>

	<!-- Module list for content admin -->
	<reports id="31" type_of_report="table">
		<column columnHandler="NONE" display_name="Order" isVisible="true" name="order_id" />
		<column columnHandler="NONE" display_name="Module ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_title" />
		<column columnHandler="NONE" display_name="Sessions" isVisible="true" name="session_count" />
		<column columnHandler="NONE" display_name="Lessons" isVisible="true" name="lesson_count" />
		<column columnHandler="NONE" display_name="Published Lessons" isVisible="true" name="published_lesson_count" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>select M.order_id as order_id, M.id as task_id , M.module_name as module_title, count(DISTINCT S) as session_count, count(L) as lesson_count,  sum(case when T.status = 'PUBLISHED' then 1 else 0 end) as published_lesson_count
from  module M
	left join cmsession S on S.module_id=M.id 
	left join lesson L on L.session_id=S.id
	left join task T on T.item_id=L.id
where  T.item_type='LESSON' and T.status!='DELETED' and M.course_id=:course_id
group by task_id
order by order_id
		</sql>
		<title> Module list</title>
	</reports>

	<!-- Session list for content admin -->
	<reports id="32" type_of_report="table">
		<column columnHandler="NONE" display_name="Order" isVisible="true" name="order_id" />
		<column columnHandler="NONE" display_name="Session ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Lessons" isVisible="true" name="lesson_count" />
		<column columnHandler="NONE" display_name="Published Lessons" isVisible="true" name="published_lesson_count" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>select S.order_id as order_id, S.id as task_id , S.title as session_title, count(L) as lesson_count,  sum(case when T.status = 'PUBLISHED' then 1 else 0 end) as published_lesson_count
from  cmsession S
	left join lesson L on L.session_id=S.id
	left join task T on T.item_id=L.id
where  T.item_type='LESSON' and T.status!='DELETED' and S.module_id=:module_id
group by task_id
order by order_id
		</sql>
		<title> Session list</title>
	</reports>

	<!-- Lesson list for content admin -->
	<reports id="33" type_of_report="table">
		<column columnHandler="NONE" display_name="Order" isVisible="true" name="order_id" />
		<column columnHandler="NONE" display_name="Lesson ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Status" isVisible="true" name="status" />
		<column columnHandler="NONE" display_name="Lesson Type" isVisible="true" name="lesson_type" />
		<column columnHandler="COURSE_HANDLER" display_name="Action" isVisible="true" name="status" />

		<sql>select DISTINCT T.id as task_id, L.order_id as order_id, T.status as status, L.title as lesson_title, (case when L.id = P.lesson_id then 'Presentation' when L.id=A.lesson_id then 'Assessment' when L.id=G.lesson_id then 'Game' else 'EMPTY' end) as lesson_type
from task T, lesson L 
	left join presentaion P on P.lesson_id = L.id 
	left join assessment A on A.lesson_id = L.id
	left join game G on G.lesson_id = L.id
where T.item_id = L.id and T.item_type= 'LESSON' and T.status!='DELETED' and L.session_id = :session_id
order by order_id
		</sql>
		<title> Lesson list</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->



	<!-- Content Reviewer -->
	<reports id="40" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT content_reviewer.name, count(*) FROM public.task, public.content_reviewer WHERE task.actor_id = content_reviewer.id group by content_reviewer.name</sql>
		<title>My Name is CONTENT reviewer </title>
	</reports>
	<reports id="41" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.content_reviewer WHERE task.actor_id = content_reviewer.id group by task.status</sql>
		<title>My Name is content REVIEWER</title>
	</reports>

	<!-- Assigned lesson list for Content Reviewer -->
	<reports id="42" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Created by" isVisible="true" name="actor" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'COMPLETED' AND (B.status LIKE 'REVIEWER_ASSIGNED' OR B.status LIKE 'DIS_APPROVED') AND A.item_type ='LESSON' AND B.reviewer_id=:content_reviewer_id
			GROUP BY A.ID, L.id,d.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Assigned</title>
	</reports>

	<!-- Disapproved lesson list for Content Reviewer -->
	<reports id="43" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Created By" isVisible="true" name="actor" />
		<!-- <column columnHandler="NONE" display_name="Status" isVisible="true" name="status" /> -->

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			B.status LIKE 'DIS_APPROVED' AND A.item_type ='LESSON' AND B.reviewer_id=:content_reviewer_id
			GROUP BY A.ID, L.id,d.email, L.title, CM.title, M.module_name,
			CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Disapproved</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<!-- Creative creator -->
	<reports id="60" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT creative_creator.name, count(*) FROM public.task, public.creative_creator WHERE task.actor_id = creative_creator.id group by creative_creator.name</sql>
		<title>My Name is Creative Creator </title>
	</reports>
	<reports id="61" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.creative_creator WHERE task.actor_id = creative_creator.id group by task.status</sql>
		<title>My Name is Creative Creatorrrrrrr</title>
	</reports>

	<!-- Assigned media task list for creative creator -->
	<reports id="62" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			A.status as status,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description
			WHEN 'VIDEO' THEN V.description
			ELSE 'None' END) as description,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id)
			LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id)
			LEFT JOIN public.creative_creator CR ON (CR.id=A.actor_id)
			LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND
			A.status='CREATIVE_ASSIGNED' AND A.actor_id = :creative_creator_id
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks Assigned</title>
	</reports>

	<!-- Inprogess media task list for creative creator -->
	<reports id="63" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,A.status as status,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description
			WHEN 'VIDEO' THEN V.description
			ELSE 'None' END) as description,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id)
			LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id)
			LEFT JOIN public.creative_creator CR ON (CR.id=A.actor_id)
			LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='DRAFT' AND
			A.actor_id = :creative_creator_id
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks in Progress</title>
	</reports>

	<!-- Not reviewed media task list for creative creator -->
	<reports id="64" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			A.status as status,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description
			WHEN 'VIDEO' THEN V.description
			ELSE 'None' END) as description,
			D.name as created_by
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id)
			LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id)
			LEFT JOIN public.creative_creator CR ON (CR.id=A.actor_id)
			LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='COMPLETED' AND
			A.actor_id = :creative_creator_id
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks Pending Review</title>
	</reports>

	<!-- Disapproved media task list for creative creator -->
	<reports id="65" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Media Type" isVisible="true" name="item_type" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />
		<column columnHandler="NONE" display_name="Review Comments" isVisible="true" name="review_comments" />
		<column columnHandler="STATUS_HANDLER" display_name="status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id,A.status as status, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,A.status as status11,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description
			WHEN 'VIDEO' THEN V.description
			ELSE 'None' END) as description,
			(CASE M.task_id WHEN A.id THEN M.comment ELSE 'No comments' END) as review_comments, D.name as created_by
			FROM public.task A
			LEFT JOIN public.media_review M ON (M.task_id=A.id)
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id) LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id) LEFT JOIN public.creative_creator CR ON (CR.id=A.actor_id) LEFT JOIN public.image I ON (A.item_id=I.id)
			LEFT JOIN
			public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.status='DIS_APPROVED' AND A.actor_id = :creative_creator_id
			GROUP BY A.id, A.item_id ,M.task_id,M.comment,CM.title,I.title,V.title,D.name ,I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks Disapproved</title>
	</reports>

	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<!-- Content Creator -->
	<reports id="80" type_of_report="table">
		<column>name</column>
		<column>count</column>
		<sql>SELECT content_creator.name, count(*) FROM public.task, public.content_creator WHERE task.actor_id = content_creator.id group by content_creator.name</sql>
		<title>Title</title>
	</reports>
	<reports id="81" type_of_report="table">
		<column>status</column>
		<column>count</column>
		<sql>SELECT task.status, count(*) FROM public.task, public.content_creator WHERE task.actor_id = content_creator.id group by task.status</sql>
		<title>TITLE</title>
	</reports>

	<!-- Assigned lesson list for content creator -->
	<reports id="82" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name, array_to_string(array_agg(C.name), ',') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'CONTENT_ASSIGNED' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id,
			d.email, L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Assigned </title>
	</reports>

	<!-- Inprogress lesson list for content creator -->
	<reports id="83" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			array_to_string(array_agg(C.name), ',') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'DRAFT' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id, d.email, L.title,
			CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks in Progress</title>
	</reports>

	<!-- Disapproved lesson list for content creator -->
	<reports id="84" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name, array_to_string(array_agg(C.name), ',') as reviewers,A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'DIS_APPROVED' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id, d.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Disapproved</title>
	</reports>

	<!-- Approved lesson list for content creator -->
	<reports id="85" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="STATUS_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name, array_to_string(array_agg(C.name), ',') as reviewers, A.status as status
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'APPROVED' AND A.item_type ='LESSON' AND A.actor_id=:content_creator_id
			GROUP BY A.ID, L.id, d.email,
			L.title, CM.title, M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Approved</title>
	</reports>

	<!-- Created media list for content creator -->
	<reports id="86" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Media Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Description" isVisible="true" name="description" />

		<column columnHandler="MEDIA_LINK_HANDLER" display_name="URL" isVisible="true" name="url" />
		<column columnHandler="NONE" display_name="Assigned to" isVisible="true" name="actor" />
		<column columnHandler="NONE" display_name="status" isVisible="true" name="status" />

		<sql>SELECT
			A.id as task_id, A.item_id as item_id, A.item_type as item_type, (CASE A.item_type WHEN 'IMAGE' THEN I.title
			WHEN 'VIDEO' THEN V.title
			ELSE 'None' END) as title,
			CM.title as session_title,
			( CASE A.item_type WHEN 'IMAGE' THEN I.description WHEN 'VIDEO' THEN V.description
			ELSE 'None'
			END) as description,
			(CASE A.item_type WHEN 'IMAGE' THEN I.url WHEN 'VIDEO' THEN V.url
			ELSE 'None' END) as url,
			A.status as status, (CASE A.actor_id WHEN AD.id THEN AD.name WHEN CR.id THEN CR.name
			ELSE 'Not Assigned'
			END) as Actor
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.owner_id)
			LEFT JOIN public.creative_admin AD ON (A.actor_id=AD.id)
			LEFT JOIN public.creative_creator CR ON (CR.id=A.actor_id)
			LEFT JOIN
			public.image I ON (A.item_id=I.id)
			LEFT JOIN public.video V ON (A.item_id=V.id)
			INNER JOIN public.cmsession CM ON (I.session_id= CM.id)
			WHERE
			A.item_type !='LESSON' AND A.owner_id=:content_creator_id
			GROUP BY A.id, A.item_id ,CM.title,I.title,V.title, I.description,V.description, I.url,V.url, A.status, AD.id, CR.id ORDER BY a.id
		</sql>
		<title> All Media Tasks created</title>
	</reports>

	<!-- Published lesson list for content creator -->
	<reports id="87" type_of_report="table">
		<column columnHandler="NONE" display_name="Task ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Lesson Title" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Session Title" isVisible="true" name="session_title" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Reviewers" isVisible="true" name="reviewers" />
		<column columnHandler="NONE" display_name="Assigned To" isVisible="true" name="actor" />
		<column columnHandler="LESSON_LINK_HANDLER" display_name="Preview" isVisible="true" name="status" />

		<sql>SELECT
			a.id AS task_id,L.id as lesson_id, L.title as lesson_title, CM.title as session_title, M.module_name as module_name, CC.course_name as course_name,
			d.email as actor,array_to_string(array_agg(C.name), ',') as reviewers
			FROM public.task A
			LEFT JOIN public.content_creator D ON (D.id=A.actor_id)
			LEFT JOIN public.task_reviewer B ON(A.id=B.task_id)
			LEFT JOIN public.content_reviewer C ON (C.id=B.reviewer_id)
			LEFT JOIN public.lesson L ON (A.item_id=L.id)
			INNER JOIN public.cmsession CM ON (L.session_id= CM.id)
			INNER JOIN public.module M ON (M.id=CM.module_id)
			INNER JOIN public.course CC ON (CC.id=M.course_id)
			WHERE
			A.status LIKE 'PUBLISHED' AND A.item_type ='LESSON'
			GROUP BY A.ID, L.id,d.email, L.title, CM.title,
			M.module_name, CC.course_name
			ORDER BY a.id
		</sql>
		<title> All Tasks Published</title>
	</reports>
	
	<reports id="88" type_of_report="table">
		<column columnHandler="NONE" display_name="LO ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Type of LO" isVisible="true" name="obj_type" />
		<column columnHandler="NONE" display_name="LO" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Subject" isVisible="true" name="subject" />

		<column columnHandler="LO_LINK_HANDLER" display_name="Status" isVisible="true" name="status" />

		<sql>select id as task_id, obj_type, title, subject from learning_objective
		</sql>
		<title> All Tasks Published</title>
	</reports>
	
	<reports id="89" type_of_report="table">
		<column columnHandler="NONE" display_name="#" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Title" isVisible="true" name="assessmenttitle" />
		<column columnHandler="NONE" display_name="Type" isVisible="true" name="assessment_type" />
		<column columnHandler="ASSESSMENT" display_name="Action" isVisible="true" name="status" />
		
		<sql>select id as task_id, assessment_type, assessmenttitle from assessment
		</sql>
		<title> All assessments</title>
	</reports>
	
	<reports id="90" type_of_report="table">
		<column columnHandler="NONE" display_name="Course ID" isVisible="true" name="cid" />
		<column columnHandler="NONE" display_name="Module Title" isVisible="true" name="mid" />
		<column columnHandler="NONE" display_name="Session ID" isVisible="true" name="cmid" />
		<column columnHandler="NONE" display_name="Lesson ID" isVisible="true" name="lid" />
		<column columnHandler="NONE" display_name="Course Title" isVisible="true" name="course_name" />
		<column columnHandler="NONE" display_name="Module Name" isVisible="true" name="module_name" />
		<column columnHandler="NONE" display_name="title" isVisible="true" name="title" />
		
		
		<sql>SELECT C.id AS cid,
       M.id AS mid,
       CM.id AS cmid,
       L.id AS lid,
       C.course_name,
       M.module_name,
       L.title
FROM course C,
     cmsession CM,
     module M,
     lesson L,
     task T,
     student S,
     batch_group BG,
     batch_students BS,
     batch_course BC
WHERE C.id = M.course_id
  AND M.id = CM.module_id
  AND CM.id = L.session_id
  AND L.id=T.item_id
  AND T.item_type='LESSON'
  AND T.status='PUBLISHED'
  AND S.istar_authorization_token = :istar_authorization_token
  AND BC.course_id=C.id
  AND BC.batch_group_id=BG.id
  AND BS.student_id= S.id
  AND BS.batch_group_id=BG.id

		</sql>
		<title> Course List</title>
	</reports>
	
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<!-- Trainer -->
	<!-- Trainer list -->
	<reports id="100" type_of_report="table">
		<column columnHandler="NONE" display_name="Trainer ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Name" isVisible="true" name="name" />
		<column columnHandler="NONE" display_name="Gender" isVisible="true" name="gender" />
		<column columnHandler="NONE" display_name="E-Mail" isVisible="true" name="email" />
		<column columnHandler="TRAINER" display_name="Status" isVisible="true" name="status" />

		<sql>select id as task_id, name as name, gender as gender, email as email 
			from trainer 
			ORDER BY task_id
		</sql>
		<title> Trainer list </title>
	</reports>
	
	<!-- Trainer Assessment list -->
	<reports id="101" type_of_report="table">
		<column columnHandler="NONE" display_name="Trainer ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Assessment Title" isVisible="true" name="title" />
		<column columnHandler="NONE" display_name="Questions" isVisible="true" name="question_count" />
		<column columnHandler="TRAINER" display_name="Score" isVisible="true" name="status" />
		
		<sql>select T.id as task_id, A.assessmenttitle as title, A.number_of_questions as question_count, (CASE WHEN R.score IS NULL THEN 'PENDING' ELSE R.score||'' END) as status
			from assessment A, event  E, assessment_event  AE
		  		 LEFT JOIN trainer T on (T.id = :trainer_id)
				 LEFT JOIN report  R on (R.assessment_id = AE.assessment and R.user_id = T.id)
			where AE.event_id = E.id and
      			 AE.assessment = A.id and
      			 E.actor_id = :trainer_id
      		order by T.id
		</sql>
		<title> Trainer list </title>
	</reports>
	
	<!-- Trainer Assessment Report -->
	<reports id="102" type_of_report="table">
		<column columnHandler="NONE" display_name="Question" isVisible="true" name="question" />
		<column columnHandler="NONE" display_name="Result" isVisible="true" name="is_correct" />
		<column columnHandler="NONE" display_name="Selected Options" isVisible="true" name="selected_options" />
		<column columnHandler="NONE" display_name="Correct Options" isVisible="true" name="correct_options" />

		<sql>
SELECT 

A.assessmenttitle as assessment_title,
(
CASE SA.correct 
WHEN 'f' THEN 'incorrect'
ELSE 'correct'
END
) is_correct,

(
CASE SA.option1
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 0))
ELSE ''
END
)
||
(
CASE SA.option2
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 1))
ELSE ''
END
) 
||
(
CASE SA.option3
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 2))
ELSE ''
END
)
||
(
CASE SA.option4
WHEN 't' THEN ((SELECT AO.text||', ' as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 3))
ELSE ''
END
)
||
(
CASE SA.option5
WHEN 't' THEN ((SELECT AO.text as text FROM assessment_option AO WHERE AO.question_id=SA.question_id ORDER BY AO.id LIMIT 1 OFFSET 4))
ELSE ''
END
)as selected_options,

(SELECT
string_agg(AOO.text,', ')

FROM  assessment_option AOO

WHERE AOO.marking_scheme=1
AND AOO.question_id=SA.question_id

) as correct_options,
Q.question_text as question

FROM student_assessment SA, question Q, assessment A
WHERE SA.student_id= :trainer_id
AND Q.id = SA.question_id
AND SA.assessment_id = :assessment_id
		</sql>
		<title> Trainer Assessment Report</title>
	</reports>
	
	
	<reports id="150" type_of_report="table">
		<column columnHandler="NONE" display_name="Handout ID" isVisible="true" name="handout_id" />
		<column columnHandler="NONE" display_name="Handout Title" isVisible="true" name="handout_title" />
		<!-- <column columnHandler="NONE" display_name="Lesson ID" isVisible="true" name="lesson_id" /> -->
		<column columnHandler="NONE" display_name="Lesson Name" isVisible="true" name="lesson_title" />
		<column columnHandler="NONE" display_name="Handouts" isVisible="true" name="handout_data" />
		<!-- <column columnHandler="NONE" display_name="Course Name" isVisible="true" name="course_name" /> -->
		<column columnHandler="HANDOUT_HANDLER" display_name="Edit" isVisible="true" name="handout_id" />

		<sql>
		select DISTINCT ll.title as lesson_title, ll.id as lesson_id , hh.title as handout_title,  hh.id as handout_id , hh.handout_text as handout_data
from handouts hh, lesson ll 
where hh.lesson_id=ll.id 

		
		</sql>
		<title> All Handouts</title>
	</reports>
	
	
	<reports id="151" type_of_report="table">
		<column columnHandler="NONE" display_name="Company ID" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Company Name" isVisible="true" name="company_name" />
		<column columnHandler="VACANCY_HANDLER" display_name="Vacancies" isVisible="true" name="task_id" /> 
		<sql>
		select id as task_id, name as company_name from recruiter_company;
		</sql>
		<title> All Companies</title>
	</reports>
	
	<reports id="152" type_of_report="table">
		
			<column columnHandler="NONE" display_name="JD ID"  is_updatetable="false" isVisible="true" name="id" />
			   
		<column columnHandler="NONE" display_name="profile_title" is_updatetable="true" isVisible="true" name="profile_title" />
		<column columnHandler="NONE" display_name="location" is_updatetable="true" isVisible="true" name="location" />
		<column columnHandler="NONE" display_name="description" is_updatetable="true" isVisible="true" name="description" />
		<column columnHandler="EDIT_DELETE_HANDLER" display_name="Edit" is_updatetable="false"  isVisible="true" name="id" />
	<table_name>
		 vacancy
		</table_name>
		<sql>select id ,  profile_title, location, description  from vacancy where company_id=:company_id</sql>
		<update_sql>
		SELECT distinct RC.id as task_id, 
RC.name as company_name,
V.profile_title as jd_title,
V.location as jd_location,
V.description as jd_description
FROM
	recruiter_company RC,
	vacancy V
WHERE
RC.id = V.company_id
AND V.id =:id
		</update_sql>
		<title> All Vacancies</title>
	</reports>
	
	<reports id="153" type_of_report="table">
		<column columnHandler="NONE" display_name="JD ID" is_updatetable="false" isVisible="true" name="task_id" />
		<column columnHandler="NONE" display_name="Company Name" is_updatetable="false" isVisible="true" name="company_name" />
		<column columnHandler="NONE" display_name="JD Title" is_updatetable="true" isVisible="true" name="jd_title" />
		<column columnHandler="NONE" display_name="JD Location" is_updatetable="true" isVisible="true" name="jd_location" />
		<column columnHandler="NONE" display_name="JD Description" is_updatetable="true" isVisible="true" name="jd_description" />
		<!-- <column columnHandler="EDIT_DELETE_HANDLER" display_name="Edit" is_updatetable="" isVisible="true" name="task_id" /> -->
		<sql>
		SELECT distinct RC.id as task_id, 
RC.name as company_name,
V.profile_title as jd_title,
V.location as jd_location,
V.description as jd_description
FROM
	recruiter_company RC,
	vacancy V
WHERE
RC.id = V.company_id
AND V.id =:id
		</sql>
		<title> Edit Vacancy</title>
	</reports>
	
	
	<!--  DOubt List  -->
	
	<reports id="159" type_of_report="table">
		<column columnHandler="NONE" display_name="JD ID" is_updatetable="false" isVisible="true" name="id" />
		<column columnHandler="NONE" display_name="Student Email " is_updatetable="false" isVisible="true" name="student_email" />
		<column columnHandler="NONE" display_name="Orgnaization Name" is_updatetable="true" isVisible="true" name="organization_email" />
		<column columnHandler="NONE" display_name="Quesstion" is_updatetable="true" isVisible="true" name="dquestion" />
		<column columnHandler="NONE" display_name="Answer" is_updatetable="true" isVisible="true" name="danswer" />
		<column columnHandler="ANSWER_DOUBT" display_name="Edit" is_updatetable="" isVisible="true" name="task_id" />
		<sql>
		SELECT
	DISTINCT d. ID AS id,
	s.email AS student_email,
	o. NAME AS organization_email,
	d.question AS dquestion,
	d.answer danswer,  d. ID task_id
FROM
	doubt d,
	student s,
	organization o, 
  content_creator cc
WHERE
	s. ID = d.student_id
AND s.organization_id = o.ID


		</sql>
		<title>View Doubts by Students</title>
	</reports>
</istar_reports>